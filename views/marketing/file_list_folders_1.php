<?phpsession_start();require_once '../../includes/views/define_include.php';require_once '../../classes/marketing/file_upload.php';$loginManager = new LoginManager();$logerHD = new LoggerHD();$page = new Page();$page->setIcon("iconfa-home");$page->setHeader("Call Disposition");$page->setTag_line("view_files");$page->setMenu_active("file_upload");$page->setMenu_group("file_upload");if (!$loginManager->confirm_member()) {    header('Location: ../../index.php');}// Force download of image file specified in URL query string and which // is in the same directory as this script: // grab the requested file's name$file_upload = new gDriveUpload();if(isset($_GET['delete_id'])){	$added_by = $_SESSION['user_id'];	$file_upload->deleteFiles($_GET['delete_id'],$added_by);	header("Location:file_list_folders.php");}if(isset($_GET['file'])){@$file_name = $_GET['file'];// make sure it's a file before doing anything!if(is_file($file_name)) {	/*		Do any processing you'd like here:		1.  Increment a counter		2.  Do something with the DB		3.  Check user permissions		4.  Anything you want!	*/	// required for IE	if(ini_get('zlib.output_compression')) { ini_set('zlib.output_compression', 'Off');	}	// get the file mime type using the file extension	switch(strtolower(substr(strrchr($file_name, '.'), 1))) {		case 'pdf': $mime = 'application/pdf'; break;		case 'zip': $mime = 'application/zip'; break;		case 'jpeg':		case 'jpg': $mime = 'image/jpg'; break;		default: $mime = 'application/force-download';	}	header('Pragma: public'); 	// required	header('Expires: 0');		// no cache	header('Cache-Control: must-revalidate, post-check=0, pre-check=0');	header('Last-Modified: '.gmdate ('D, d M Y H:i:s', filemtime ($file_name)).' GMT');	header('Cache-Control: private',false);	header('Content-Type: '.$mime);	header('Content-Disposition: attachment; filename="'.basename($file_name).'"');	header('Content-Transfer-Encoding: binary');	header('Content-Length: '.filesize($file_name));	// provide file size	header('Connection: close');	readfile($file_name);		// push it out	exit();  }}$drop_downs = new DropDownlist();$getAllGraphicsMainCategory = $drop_downs->getAllGraphicsMainCategory();$getAllGraphicsSubCategory = $drop_downs->getAllGraphicsSubCategory();$getAllGraphicsBusinessName = $drop_downs->getAllGraphicsBusinessName();$getAllGraphicsPaperSize = $drop_downs->getAllGraphicsPaperSize();$getAllCarrier = $drop_downs->getAllCarrier();$getAllGraphicsDealerTypes = $drop_downs->getAllGraphicsDealerTypes();$getAllSLUsers = $drop_downs->getAllSLUsers();?>   <!DOCTYPE html><html lang="en">    <head>        <!-- class head -->        <?php require("../../includes/views/head.php") ?>        <!-- class head -->        <script>           ///////////////////// add invoice number ////////////////        jQuery(document).ready(function () {          jQuery('#loading').fadeOut();            jQuery('#returninvoiceModal').on('show.bs.modal', function (e) {                $('.modal-backdrop').fadeIn(150);                var file_name_id = jQuery(e.relatedTarget).data('item-id');                              jQuery.ajax({                                type: "POST",                                url: "ajax_show_graphic_details.php",                                cache: false,                                data: {id: file_name_id},                                    beforeSend: function() {                                         $("#returninvoiceModal").find('#orderDetails').html("Loading.Please Wait...");                                },                                success: function (records) {                                    $("#returninvoiceModal").find('#orderDetails').html(records);                                }                            });            });            jQuery('#returninvoiceModal').on('hide.bs.modal', function (e) {                 $("#returninvoiceModal").find('#orderDetails').html("");                $('.modal-backdrop').fadeOut(150);            });        });			jQuery(document).ready(function () {      $("#daterange").daterangepicker({ 	       locale: {		     "cancelLabel": "Clear"           }      });	  	  $("#daterange").on('apply.daterangepicker', function(ev, picker) {          var daterange = $('#daterange').val();			  updateResults();      });      $("#daterange").on('cancel.daterangepicker', function(ev, picker) {         var todate = $('#todate').val();			 		 $(this).val(todate);           updateResults();      });       jQuery('body').on('change', '.search', function() {             updateResults();      });        function updateResults() {	    jQuery('#loading').fadeIn();		  jQuery("#image_container").animate({                'opacity': 0.2            });        var maincategory = $('#maincategory').val();			var subCategory = $('#subCategory').val();			var businessName = $('#businessName').val();			var dealertype = $('#dealertype').val();			var carrier = $('#carrier').val();	    var designedBy = $('#designedBy').val();			var daterange = $('#daterange').val();			var flyer_name = $('#flyer_name').val();			var formData = {			maincategory:maincategory,		    subCategory:subCategory,		    businessName:businessName,		    dealertype:dealertype,		    carrier:carrier,			designedBy:designedBy,			flyer_name:flyer_name,            daterange:daterange					}				$.ajax({           url : "ajax_file_list_folders.php",           type: "POST",           data : formData,           success: function(data)           {			  jQuery('#loading').fadeOut();              jQuery("#image_container").html(data);			  jQuery("#image_container").animate({                'opacity': 1              });           },           error: function (jqXHR, textStatus, errorThrown)           {            }         });		   }	       });	    </script>		        <style>		#loading {    background:url(loading.gif) no-repeat center center;    height: 100px;    width: 100px;    position: fixed;    padding-top: 15%;    left: 50%;    //top: 20%;    // margin: -25px 0 0 -25px;    z-index: 1000;}            * {                -webkit-box-sizing: border-box;                -moz-box-sizing: border-box;                box-sizing: border-box;            }            body {                font-family: sans-serif;            }            /* ---- button ---- */            .button {                display: inline-block;                padding: 0.5em 1.0em;                background: #EEE;                border: none;                border-radius: 7px;                background-image: linear-gradient( to bottom, hsla(0, 0%, 0%, 0), hsla(0, 0%, 0%, 0.2) );                color: #222;                font-family: sans-serif;                font-size: 16px;                // text-shadow: 0 1px white;                // cursor: pointer;            }            .button1 {                font-weight: bold;                color: #000;            }            .button1:hover {                             color: #222;            }            .button1:active,            .button1.is-checked {                font-weight: bold;               }            .button1.is-checked {                font-weight: bold;                 color: #D00D3D;                //color: red;                // background-color: #28F;                // text-shadow: 0 -1px hsla(0, 0%, 0%, 0.8);            }            .button1:active {                // box-shadow: inset 0 1px 10px hsla(0, 0%, 0%, 0.8);            }            /* ---- button-group ---- */            .button-group:after {                content: '';                display: block;                clear: both;            }            .button-group .button {                float: left;                border-radius: 0;                margin-left: 0;                margin-right: 1px;            }            .button-group .button:first-child { border-radius: 0.5em 0 0 0.5em; }            .button-group .button:last-child { border-radius: 0 0.5em 0.5em 0; }            /* ---- isotope ---- */            /*  .isotope {                  border: 1px solid #333;              }*/            /* clear fix */            .isotope:after {                content: '';                display: block;                clear: both;            }            /* ---- .element-item ---- */            .element-item {                position: relative;                float: left;                width: auto;                margin: 10px 5px 5px 20px;                padding: 50px;                color: #fff;                border: 1px solid #C5C5C5;                 background-color: #f2f2f2;            }            #filters{                margin-left:20px;            }            .tools{                padding:0 0 0 0 !important;                 margin-top:5px;            }            .actions{                            }            #returninvoiceModal{               // width:500px;            }                        .modal .modal-dialog { width: 700px; }            .imgDiv1{				//height:50px;                // min-height:10%; height:50%;				// min-width:22%;            }// crop.thumbnail1 { overflow: hidden;}.thumbnail1 img {  position: absolute;  left: 50%;  top: 50%;  height: 100%;  width: auto;  -webkit-transform: translate(-50%,-50%);      -ms-transform: translate(-50%,-50%);          transform: translate(-50%,-50%);		  		}.thumbnail img.portrait {  width: 100%;  height: auto;}/* drop down */#container {  border: 1px solid;  padding: 3px;}.item {  width: 70px;  height: 70px;  margin: 3px;  float: left;  color: white;  font-weight: bold;  text-shadow: 1px 1px black;}.item.next {  width: 60px;  height: 60px;  border: 5px solid black;  border-radius: 35px;}.supplier-search ul,.sub-category ul,.carrier ul{    display:none;}/* Start: Recommended Isotope styles *//**** Isotope Filtering ****/.isotope-item {  z-index: 2;}.isotope-hidden.isotope-item {  pointer-events: none;  z-index: 1;}/**** Isotope CSS3 transitions ****/.isotope,.isotope .isotope-item {  -webkit-transition-duration: 0.8s;     -moz-transition-duration: 0.8s;          transition-duration: 0.8s;}.isotope {  -webkit-transition-property: height, width;     -moz-transition-property: height, width;          transition-property: height, width;}.isotope .isotope-item {  -webkit-transition-property: -webkit-transform, opacity;     -moz-transition-property:    -moz-transform, opacity;          transition-property:         transform, opacity;}/**** disabling Isotope CSS3 transitions ****/.isotope.no-transition,.isotope.no-transition .isotope-item,.isotope .isotope-item.no-transition {  -webkit-transition-duration: 0s;     -moz-transition-duration: 0s;          transition-duration: 0s;}/* End: Recommended Isotope styles */ #uuu{  width:  150px; /*or 70%, or what you want*/  height: 150px; /*or 70%, or what you want*/  background-size: cover;  background-position: center;  background-repeat: no-repeat;}    </style>	<link rel="stylesheet" href="css/style.css" type="text/css" media="screen"/>    <link rel="stylesheet" href="css/thirdeffect1.css" type="text/css" media="screen"/>			    </head>    <!-- END HEAD -->    <!-- BEGIN BODY -->    <body class="page-header-fixed page-footer-fixed page-quick-sidebar-over-content">        <!-- BEGIN HEADER -->        <?php require("../../includes/views/header_admin.php") ?>        <!-- END HEADER -->        <div class="clearfix">        </div>        <!-- BEGIN CONTAINER -->        <div class="page-container">            <!-- BEGIN SIDEBAR -->            <?php require("../../includes/views/quick_sidebar.php") ?>            <!-- END SIDEBAR -->            <!-- BEGIN CONTENT -->            <div class="page-content-wrapper">                <div class="page-content" style="min-height: 950px;">                    <!-- BEGIN PAGE HEADER-->                    <div id="hide"><?php include ("../../includes/views/messager.php"); //Display  Messages for Entered Data ?></div>                    <!-- END PAGE HEADER-->                    <!-- BEGIN PAGE CONTENT-->                    <div class="row" >                        <div class="col-md-12">                                    <div class="portlet box green">                                        <div class="portlet-title">                                            <div class="caption">                                                View Uploaded Files                                            </div>                                            <div class="tools">                                                <a href="file_upload" class="btn default" style="text-decoration:none; height:30px;">Upload File</a>                                            </div>                                        </div>                                        <div class="portlet-body form" style="min-height:1000px"><br /><!--<a class="btn btn-xs red" href="?fileID=0Byz4UgDEDPszNjFLUmFxSXI2RGc"><i class="fa fa-trash-o"></i></a>-->                                            <?php                                        $file_upload = new gDriveUpload();                                     	$viewMainCategoryName = $file_upload->viewMainCategoryName();			                //echo "<pre>";				                   	$viewUploadedFiles = $file_upload->viewUploadedFiles();									//print_r($results);                                                ?>                                            <div class="row" style="margin-left:20px;">												                                                                <div class="col-md-2">																 <h4 class="help-block"> Main Category : </h4>                                                                    <select name="maincategory" class="input-small input-sm form-control search" id="maincategory">                                                                        <option value="" selected="true">--- Select ---</option>                                                                        <?php                                                                        foreach ($getAllGraphicsMainCategory as $values) {                                                                            ?>                                                                            <option value="<?php echo $values['category_id']; ?>"><?php echo $values['category_name']; ?></option>                                                                        <?php } ?>                                                                    </select>                                                                </div>																																																<div class="col-md-2">																 <h4 class="help-block"> Sub Category : </h4>                                                                    <select name="subCategory" class="input-small input-sm form-control search" id="subCategory">                                                                        <option value="" selected="true">--- Select ---</option>                                                                        <?php                                                                        foreach ($getAllGraphicsSubCategory as $values) {                                                                            ?>                                                                            <option value="<?php echo $values['sub_category_id']; ?>"><?php echo $values['sub_category_name']; ?></option>                                                                        <?php } ?>                                                                    </select>																	                                                                </div>																	<div class="col-md-2">																 <h4 class="help-block"> Business Name : </h4>                                                                    <select name="businessName" class="input-small input-sm form-control search" id="businessName">                                                                        <option value="" selected="true">--- Select ---</option>                                                                        <?php                                                                        foreach ($getAllGraphicsBusinessName as $values) {                                                                            ?>                                                                            <option value="<?php echo $values['business_id']; ?>"><?php echo $values['business_name']; ?></option>                                                                        <?php } ?>                                                                    </select>                                                                </div>																																	<div class="col-md-2">																 <h4 class="help-block"> Dealer Types : </h4>                                                                      <select name="dealertype" class="input-small input-sm form-control search" id="dealertype">                                                                        <option value="" selected="true">--- Select ---</option>                                                                        <?php                                                                        foreach ($getAllGraphicsDealerTypes as $index=>$values) {                                                                            ?>                                                                            <option value="<?php echo $index; ?>"><?php echo $values; ?></option>                                                                        <?php } ?>                                                                    </select>                                                                </div>																																		<div class="col-md-2">																 <h4 class="help-block"> Carrier : </h4>                                                                   <select name="carrier" class="input-small input-sm form-control search" id="carrier">                                                                        <option value="" selected="true">--- Select ---</option>                                                                        <?php                                                                        foreach ($getAllCarrier as $values) {                                                                            ?>                                                                            <option value="<?php echo $values['carrier_id']; ?>"><?php echo $values['carrier_name']; ?></option>                                                                        <?php } ?>                                                                    </select>                                                                </div></div><br />                                                                                            <div class="row" style="margin-left:20px;">												                                                                <div class="col-md-2">																 <h4 class="help-block"> Designed by : </h4>                                                                    <select name="designedBy" class="input-small input-sm form-control search" id="designedBy">                                                                        <option value="" selected="true">--- Select ---</option>                                                                        <?php                                                                        foreach ($getAllSLUsers as $values) {                                                                            ?>                                                                            <option value="<?php echo $values['user_id']; ?>"><?php echo $values['user_first_name'] . " " . $values['user_last_name']; ?></option>                                                                        <?php } ?>                                                                    </select>                                                                </div>																																																<div class="col-md-4">																 <h4 class="help-block"> Date Range : </h4>                                                                    <input type="text" class="input-large input-sm form-control search" name="daterange" id="daterange" value="01/01/2015 - <?php echo date('m/d/Y'); ?>" />                                                                </div>																	<div class="col-md-2">																 <h4 class="help-block"> Flyer Name : </h4>                                                                     <input type="text" class="input-large input-sm form-control search" name="flyer_name" id="flyer_name" value="">                                                                </div>                                                             </div>															 <input type="hidden" name="todate" id="todate" value="01/01/2015 - <?php echo date('m/d/Y'); ?>" />															                                                             <hr /> <div id="loading"></div>                                                    <div id="image_container" >                                                    <?php													if(!empty($viewUploadedFiles)){                                                    foreach ($viewUploadedFiles as $fileList) {                                                                                                           //$imgLocation = "http://www.shop.wirelesscorner.net/api1/images/".$fileList["main_category"]."/".$fileList["file_name"];													        //$imgLocation = "https://www.rdams.com/eblast_files/images/".$fileList["main_category"]."/".$fileList["file_name"];													      $imgLocation = "https://rdams.com/eblast_files/images/".$fileList["main_category"]."/".$fileList["file_name"];                                                        ?>                                                 <div class="col-md-2 col-sm-2">                        <div class="thumbnail">			<div id="uuu" style="background-image:url(<?php echo $imgLocation; ?>)"></div>              <!-- <img src="<?php echo $imgLocation; ?>" /> -->				  <div class="caption" style="text-align:center">                  					<a href="" class="label label-info" data-item-id="<?php echo $fileList["file_name_id"]; ?>" data-item-status="2" data-toggle="modal" data-target="#returninvoiceModal" title="View"><i class="fa fa-eye"></i></a>					<?php if (isset($_SESSION['user_permissions']['designer_gallery_download_image']) && $_SESSION['user_permissions']['designer_gallery_download_image'] == '1') { ?>					<a href="download?file=<?php echo $imgLocation; ?>" class="label label-info" rel="tooltip" title="Download"><i class="fa fa-download"></i></a>					<a href="file_upload_edit.php?id=<?php echo $fileList["file_name_id"]; ?>" class="label label-info" rel="tooltip" title="Edit"><i class="fa fa-pencil"></i></a>					<a href="file_list_folders.php?delete_id=<?php echo $fileList["file_name_id"]; ?>" class="label label-danger" rel="tooltip" title="Delete" onclick="return confirm('Are you sure you want to Delete?')"><i class="fa fa-times"></i></a>                  		                    <?php } ?>				 </div>            </div>        </div>														                                                    <?php                                                    }													 } else{														echo "<div style='margin-left:20px;'>No Records Found</div>";													}                                                    ?>    																										</div>                                           <div class="clear"></div>                                        </div>                                        <!-- add returned invoice no modal  -->            <div class="modal" id="returninvoiceModal" role="dialog" aria-labelledby="returninvoiceModal" style="display:none; ">                <div class="modal-dialog">                    <div class="modal-content">                        <div class="modal-header">                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&amp;times;</button>                            <h4 class="modal-title" id="myModalLabel"><b><i class="fa fa-file-pdf-o"></i> View File Details</b></h4>                        </div>                        <div id="orderDetails" class="modal-body"></div>                         </div>                </div>            </div>            <!-- end -->                                    </div>                                                  </div>                      </div>                </div>                <!-- END PAGE CONTENT-->            </div>		        </div>        <!-- END CONTENT -->        <!-- BEGIN FOOTER -->        <?php require("../../includes/views/footer_admin.php"); ?>        <!-- END FOOTER -->    </body>    <!-- END BODY -->    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.2/isotope.pkgd.min.js"></script></html><?php//Clear all the Message Session Variables...if (isset($_SESSION['returnmessage'])) {    unset($_SESSION['returnmessage']);}?>